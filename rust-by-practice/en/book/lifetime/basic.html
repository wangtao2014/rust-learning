<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>basic - Rust By Practice</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Learn Rust with Example, Exercise and real Practice, written with ❤️ by https://course.rs team">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../theme/style1.css">


    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');
                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }
                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../why-exercise.html"><strong aria-hidden="true">1.</strong> Rust By Practice</a></li><li class="chapter-item expanded "><a href="../elegant-code-base.html"><strong aria-hidden="true">2.</strong> Small projects with Elegant code</a></li><li class="chapter-item expanded "><a href="../variables.html"><strong aria-hidden="true">3.</strong> Variables</a></li><li class="chapter-item expanded "><a href="../basic-types/intro.html"><strong aria-hidden="true">4.</strong> Basic Types</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../basic-types/numbers.html"><strong aria-hidden="true">4.1.</strong> Numbers</a></li><li class="chapter-item "><a href="../basic-types/char-bool-unit.html"><strong aria-hidden="true">4.2.</strong> Char, Bool and Unit</a></li><li class="chapter-item "><a href="../basic-types/statements-expressions.html"><strong aria-hidden="true">4.3.</strong> Statements and Expressions</a></li><li class="chapter-item "><a href="../basic-types/functions.html"><strong aria-hidden="true">4.4.</strong> Functions</a></li></ol></li><li class="chapter-item expanded "><a href="../ownership/intro.html"><strong aria-hidden="true">5.</strong> Ownership and Borrowing</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../ownership/ownership.html"><strong aria-hidden="true">5.1.</strong> Ownership</a></li><li class="chapter-item "><a href="../ownership/borrowing.html"><strong aria-hidden="true">5.2.</strong> Reference and Borrowing</a></li></ol></li><li class="chapter-item expanded "><a href="../compound-types/intro.html"><strong aria-hidden="true">6.</strong> Compound Types</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../compound-types/string.html"><strong aria-hidden="true">6.1.</strong> string</a></li><li class="chapter-item "><a href="../compound-types/array.html"><strong aria-hidden="true">6.2.</strong> Array</a></li><li class="chapter-item "><a href="../compound-types/slice.html"><strong aria-hidden="true">6.3.</strong> Slice</a></li><li class="chapter-item "><a href="../compound-types/tuple.html"><strong aria-hidden="true">6.4.</strong> Tuple</a></li><li class="chapter-item "><a href="../compound-types/struct.html"><strong aria-hidden="true">6.5.</strong> Struct</a></li><li class="chapter-item "><a href="../compound-types/enum.html"><strong aria-hidden="true">6.6.</strong> Enum</a></li></ol></li><li class="chapter-item expanded "><a href="../flow-control.html"><strong aria-hidden="true">7.</strong> Flow Control</a></li><li class="chapter-item expanded "><a href="../pattern-match/intro.html"><strong aria-hidden="true">8.</strong> Pattern Match</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../pattern-match/match-iflet.html"><strong aria-hidden="true">8.1.</strong> match, matches! and if let</a></li><li class="chapter-item "><a href="../pattern-match/patterns.html"><strong aria-hidden="true">8.2.</strong> Patterns</a></li></ol></li><li class="chapter-item expanded "><a href="../method.html"><strong aria-hidden="true">9.</strong> Method & Associated function</a></li><li class="chapter-item expanded "><a href="../generics-traits/intro.html"><strong aria-hidden="true">10.</strong> Generics and Traits</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../generics-traits/generics.html"><strong aria-hidden="true">10.1.</strong> Generics</a></li><li class="chapter-item "><a href="../generics-traits/const-generics.html"><strong aria-hidden="true">10.2.</strong> Const Generics</a></li><li class="chapter-item "><a href="../generics-traits/traits.html"><strong aria-hidden="true">10.3.</strong> Traits</a></li><li class="chapter-item "><a href="../generics-traits/trait-object.html"><strong aria-hidden="true">10.4.</strong> Trait Object</a></li><li class="chapter-item "><a href="../generics-traits/advanced-traits.html"><strong aria-hidden="true">10.5.</strong> Advanced Traits</a></li></ol></li><li class="chapter-item expanded "><a href="../collections/intro.html"><strong aria-hidden="true">11.</strong> Collection Types</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../collections/string.html"><strong aria-hidden="true">11.1.</strong> String</a></li><li class="chapter-item "><a href="../collections/vector.html"><strong aria-hidden="true">11.2.</strong> Vector</a></li><li class="chapter-item "><a href="../collections/hashmap.html"><strong aria-hidden="true">11.3.</strong> HashMap</a></li></ol></li><li class="chapter-item expanded "><a href="../type-conversions/intro.html"><strong aria-hidden="true">12.</strong> Type Conversion</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../type-conversions/as.html"><strong aria-hidden="true">12.1.</strong> as</a></li><li class="chapter-item "><a href="../type-conversions/from-into.html"><strong aria-hidden="true">12.2.</strong> From/Into</a></li><li class="chapter-item "><a href="../type-conversions/others.html"><strong aria-hidden="true">12.3.</strong> Others</a></li></ol></li><li class="chapter-item expanded "><a href="../result-panic/intro.html"><strong aria-hidden="true">13.</strong> Result and panic</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../result-panic/panic.html"><strong aria-hidden="true">13.1.</strong> panic!</a></li><li class="chapter-item "><a href="../result-panic/result.html"><strong aria-hidden="true">13.2.</strong> Result and ?</a></li></ol></li><li class="chapter-item expanded "><a href="../crate-module/intro.html"><strong aria-hidden="true">14.</strong> Crate and Module</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../crate-module/crate.html"><strong aria-hidden="true">14.1.</strong> Package and Crate</a></li><li class="chapter-item "><a href="../crate-module/module.html"><strong aria-hidden="true">14.2.</strong> Module</a></li><li class="chapter-item "><a href="../crate-module/use-pub.html"><strong aria-hidden="true">14.3.</strong> Advanced use and pub</a></li></ol></li><li class="chapter-item expanded "><a href="../comments-docs.html"><strong aria-hidden="true">15.</strong> Comments and Docs</a></li><li class="chapter-item expanded "><a href="../formatted-output/intro.html"><strong aria-hidden="true">16.</strong> Formatted output</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../formatted-output/println.html"><strong aria-hidden="true">16.1.</strong> println! and format!</a></li><li class="chapter-item "><a href="../formatted-output/debug-display.html"><strong aria-hidden="true">16.2.</strong> Debug and Display</a></li><li class="chapter-item "><a href="../formatted-output/formatting.html"><strong aria-hidden="true">16.3.</strong> formating</a></li></ol></li><li class="chapter-item expanded "><a href="../lifetime/intro.html"><strong aria-hidden="true">17.</strong> Lifetime</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../lifetime/basic.html" class="active"><strong aria-hidden="true">17.1.</strong> basic</a></li><li class="chapter-item "><a href="../lifetime/static.html"><strong aria-hidden="true">17.2.</strong> &'static and T: 'static</a></li><li class="chapter-item "><a href="../lifetime/advance.html"><strong aria-hidden="true">17.3.</strong> advanced</a></li></ol></li><li class="chapter-item expanded "><a href="../functional-programing/intro.html"><strong aria-hidden="true">18.</strong> Functional programing</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../functional-programing/closure.html"><strong aria-hidden="true">18.1.</strong> Closure</a></li><li class="chapter-item "><a href="../functional-programing/iterator.html"><strong aria-hidden="true">18.2.</strong> Iterator</a></li></ol></li><li class="chapter-item expanded "><a href="../newtype-sized.html"><strong aria-hidden="true">19.</strong> newtype and DST</a></li><li class="chapter-item expanded "><a href="../smart-pointers/intro.html"><strong aria-hidden="true">20.</strong> Smart pointers TODO</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../smart-pointers/box.html"><strong aria-hidden="true">20.1.</strong> Box</a></li><li class="chapter-item "><a href="../smart-pointers/deref.html"><strong aria-hidden="true">20.2.</strong> Deref</a></li><li class="chapter-item "><a href="../smart-pointers/drop.html"><strong aria-hidden="true">20.3.</strong> Drop</a></li><li class="chapter-item "><a href="../smart-pointers/rc-arc.html"><strong aria-hidden="true">20.4.</strong> Rc and Arc</a></li><li class="chapter-item "><a href="../smart-pointers/cell-refcell.html"><strong aria-hidden="true">20.5.</strong> Cell and RefCell</a></li></ol></li><li class="chapter-item expanded "><a href="../weak.html"><strong aria-hidden="true">21.</strong> Weak and Circle reference TODO</a></li><li class="chapter-item expanded "><a href="../self-referential.html"><strong aria-hidden="true">22.</strong> Self referential TODO</a></li><li class="chapter-item expanded "><a href="../threads/intro.html"><strong aria-hidden="true">23.</strong> Threads TODO</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../threads/basic-using.html"><strong aria-hidden="true">23.1.</strong> Basic using</a></li><li class="chapter-item "><a href="../threads/message-passing.html"><strong aria-hidden="true">23.2.</strong> Message passing</a></li><li class="chapter-item "><a href="../threads/sync.html"><strong aria-hidden="true">23.3.</strong> Sync</a></li><li class="chapter-item "><a href="../threads/atomic.html"><strong aria-hidden="true">23.4.</strong> Atomic</a></li><li class="chapter-item "><a href="../threads/send-sync.html"><strong aria-hidden="true">23.5.</strong> Send and Sync</a></li></ol></li><li class="chapter-item expanded "><a href="../global-variables.html"><strong aria-hidden="true">24.</strong> Global variables TODO</a></li><li class="chapter-item expanded "><a href="../errors.html"><strong aria-hidden="true">25.</strong> Errors TODO</a></li><li class="chapter-item expanded "><a href="../unsafe/intro.html"><strong aria-hidden="true">26.</strong> Unsafe doing</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../unsafe/inline-asm.html"><strong aria-hidden="true">26.1.</strong> Inline assembly</a></li></ol></li><li class="chapter-item expanded "><a href="../macro.html"><strong aria-hidden="true">27.</strong> Macro TODO</a></li><li class="chapter-item expanded "><a href="../tests/intro.html"><strong aria-hidden="true">28.</strong> Tests TODO</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../tests/write-tests.html"><strong aria-hidden="true">28.1.</strong> Write Tests</a></li><li class="chapter-item "><a href="../tests/benchmark.html"><strong aria-hidden="true">28.2.</strong> Benchmark</a></li><li class="chapter-item "><a href="../tests/unit-integration.html"><strong aria-hidden="true">28.3.</strong> Unit and Integration</a></li><li class="chapter-item "><a href="../tests/assertions.html"><strong aria-hidden="true">28.4.</strong> Assertions</a></li></ol></li><li class="chapter-item expanded "><a href="../async/intro.html"><strong aria-hidden="true">29.</strong> Async/Await TODO</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../async/async-await.html"><strong aria-hidden="true">29.1.</strong> async and await!</a></li><li class="chapter-item "><a href="../async/future.html"><strong aria-hidden="true">29.2.</strong> Future</a></li><li class="chapter-item "><a href="../async/pin-unpin.html"><strong aria-hidden="true">29.3.</strong> Pin and Unpin</a></li><li class="chapter-item "><a href="../async/stream.html"><strong aria-hidden="true">29.4.</strong> Stream</a></li></ol></li><li class="chapter-item expanded "><a href="../std/intro.html"><strong aria-hidden="true">30.</strong> Standard Library TODO</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../std/String.html"><strong aria-hidden="true">30.1.</strong> String</a></li></ol></li><li class="chapter-item expanded "><a href="../fight-compiler/intro.html"><strong aria-hidden="true">31.</strong> Fighting with Compiler</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../fight-compiler/borrowing.html"><strong aria-hidden="true">31.1.</strong> Borrowing</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Rust By Practice</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/sunface/rust-by-practice" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/sunface/rust-by-practice/edit/master/en/src/lifetime/basic.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <!-- Page table of contents -->
                    <div class="sidetoc"><nav class="pagetoc"></nav></div>
                    <main>
                        <h2 id="lifetime"><a class="header" href="#lifetime">Lifetime</a></h2>
<p>The compiler uses lifetime to ensure all borrows are valid. Typically, a variable's lifetime begins when it is created and ends when it is destroyed.</p>
<h2 id="the-scope-of-lifetime"><a class="header" href="#the-scope-of-lifetime">The scope of lifetime</a></h2>
<p>1、 🌟</p>
<pre><pre class="playground"><code class="language-rust editable edition2021">/* Annotate the lifetime of `i` and `borrow2` */

// Lifetimes are annotated below with lines denoting the creation
// and destruction of each variable.
// `i` has the longest lifetime because its scope entirely encloses 
// both `borrow1` and `borrow2`. The duration of `borrow1` compared 
// to `borrow2` is irrelevant since they are disjoint.
fn main() {
    let i = 3;                                             
    {                                                    
        let borrow1 = &amp;i; // `borrow1` lifetime starts. ──┐
        //                                                │
        println!(&quot;borrow1: {}&quot;, borrow1); //              │
    } // `borrow1 ends. ──────────────────────────────────┘
    {                                                    
        let borrow2 = &amp;i; 
                                                        
        println!(&quot;borrow2: {}&quot;, borrow2);               
    }                                                   
}   
</code></pre></pre>
<ol start="2">
<li>🌟🌟</li>
</ol>
<p><strong>Example</strong></p>
<pre><pre class="playground"><code class="language-rust edition2021"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>{
    let x = 5;            // ----------+-- 'b
                          //           |
    let r = &amp;x;           // --+-- 'a  |
                          //   |       |
    println!(&quot;r: {}&quot;, r); //   |       |
                          // --+       |
}                         // ----------+
<span class="boring">}
</span></code></pre></pre>
<pre><pre class="playground"><code class="language-rust editable edition2021">/* Annotate `r` and `x` as above, and explain why this code fails to compile, in the lifetime aspect. */

fn main() {  
    {
        let r;                // ---------+-- 'a
                              //          |
        {                     //          |
            let x = 5;        // -+-- 'b  |
            r = &amp;x;           //  |       |
        }                     // -+       |
                              //          |
        println!(&quot;r: {}&quot;, r); //          |
    }                         // ---------+
}
</code></pre></pre>
<h2 id="lifetime-annotating"><a class="header" href="#lifetime-annotating">Lifetime annotating</a></h2>
<p>The <strong>borrow checker uses explicit lifetime annotations</strong> to determine how long a reference should be valid. </p>
<p>But for us users, in most cases, there is no need to annotate the lifetime, because there are several elision rules, before learning these rules, we need to know how to annotate lifetime manually.</p>
<h4 id="function"><a class="header" href="#function">Function</a></h4>
<p>Ignoring elision rules, lifetimes in function signatures have a few constraints:</p>
<ul>
<li>Any reference must have an annotated lifetime</li>
<li>Any reference being returned must have the same lifetime as one of the inputs or be static</li>
</ul>
<p><strong>Example</strong></p>
<pre><pre class="playground"><code class="language-rust editable edition2021">// One input reference with lifetime `'a` which must live
// at least as long as the function.
fn print_one&lt;'a&gt;(x: &amp;'a i32) {
    println!(&quot;`print_one`: x is {}&quot;, x);
}

// Mutable references are possible with lifetimes as well.
fn add_one&lt;'a&gt;(x: &amp;'a mut i32) {
    *x += 1;
}

// Multiple elements with different lifetimes. In this case, it
// would be fine for both to have the same lifetime `'a`, but
// in more complex cases, different lifetimes may be required.
fn print_multi&lt;'a, 'b&gt;(x: &amp;'a i32, y: &amp;'b i32) {
    println!(&quot;`print_multi`: x is {}, y is {}&quot;, x, y);
}

// Returning references that have been passed in is acceptable.
// However, the correct lifetime must be returned.
fn pass_x&lt;'a, 'b&gt;(x: &amp;'a i32, _: &amp;'b i32) -&gt; &amp;'a i32 { x }

fn main() {
    let x = 7;
    let y = 9;
    
    print_one(&amp;x);
    print_multi(&amp;x, &amp;y);
    
    let z = pass_x(&amp;x, &amp;y);
    print_one(z);

    let mut t = 3;
    add_one(&amp;mut t);
    print_one(&amp;t);
}
</code></pre></pre>
<p>3、 🌟</p>
<pre><pre class="playground"><code class="language-rust editable edition2021">/* Make it work by adding proper lifetime annotation */
fn longest(x: &amp;str, y: &amp;str) -&gt; &amp;str {
    if x.len() &gt; y.len() {
        x
    } else {
        y
    }
}

fn main() {}
</code></pre></pre>
<p>4、🌟🌟🌟</p>
<pre><pre class="playground"><code class="language-rust editable edition2021">// `'a` must live longer than the function.
// Here, `&amp;String::from(&quot;foo&quot;)` would create a `String`, followed by a
// reference. Then the data is dropped upon exiting the scope, leaving
// a reference to invalid data to be returned.

/* Fix the error in three ways  */
fn invalid_output&lt;'a&gt;() -&gt; &amp;'a String { 
    &amp;String::from(&quot;foo&quot;) 
}

fn main() {
}
</code></pre></pre>
<p>5、🌟🌟</p>
<pre><pre class="playground"><code class="language-rust editable edition2021">// `print_refs` takes two references to `i32` which have different
// lifetimes `'a` and `'b`. These two lifetimes must both be at
// least as long as the function `print_refs`.
fn print_refs&lt;'a, 'b&gt;(x: &amp;'a i32, y: &amp;'b i32) {
    println!(&quot;x is {} and y is {}&quot;, x, y);
}

/* Make it work */
// A function which takes no arguments, but has a lifetime parameter `'a`.
fn failed_borrow&lt;'a&gt;() {
    let _x = 12;

    // ERROR: `_x` does not live long enough
    let y: &amp;'a i32 = &amp;_x;
    // Attempting to use the lifetime `'a` as an explicit type annotation 
    // inside the function will fail because the lifetime of `&amp;_x` is shorter
    // than `'a` . A short lifetime cannot be coerced into a longer one.
}

fn main() {
    let (four, nine) = (4, 9);
    
    // Borrows (`&amp;`) of both variables are passed into the function.
    print_refs(&amp;four, &amp;nine);
    // Any input which is borrowed must outlive the borrower. 
    // In other words, the lifetime of `four` and `nine` must 
    // be longer than that of `print_refs`.
    
    failed_borrow();
    // `failed_borrow` contains no references to force `'a` to be 
    // longer than the lifetime of the function, but `'a` is longer.
    // Because the lifetime is never constrained, it defaults to `'static`.
}
</code></pre></pre>
<h4 id="structs"><a class="header" href="#structs">Structs</a></h4>
<p>6、 🌟</p>
<pre><pre class="playground"><code class="language-rust editable edition2021">/* Make it work by adding proper lifetime annotation */

// A type `Borrowed` which houses a reference to an
// `i32`. The reference to `i32` must outlive `Borrowed`.
#[derive(Debug)]
struct Borrowed(&amp;i32);

// Similarly, both references here must outlive this structure.
#[derive(Debug)]
struct NamedBorrowed {
    x: &amp;i32,
    y: &amp;i32,
}

// An enum which is either an `i32` or a reference to one.
#[derive(Debug)]
enum Either {
    Num(i32),
    Ref(&amp;i32),
}

fn main() {
    let x = 18;
    let y = 15;

    let single = Borrowed(&amp;x);
    let double = NamedBorrowed { x: &amp;x, y: &amp;y };
    let reference = Either::Ref(&amp;x);
    let number    = Either::Num(y);

    println!(&quot;x is borrowed in {:?}&quot;, single);
    println!(&quot;x and y are borrowed in {:?}&quot;, double);
    println!(&quot;x is borrowed in {:?}&quot;, reference);
    println!(&quot;y is *not* borrowed in {:?}&quot;, number);
}
</code></pre></pre>
<p>7、 🌟🌟</p>
<pre><pre class="playground"><code class="language-rust editable edition2021">/* Make it work */

#[derive(Debug)]
struct NoCopyType {}

#[derive(Debug)]
struct Example&lt;'a, 'b&gt; {
    a: &amp;'a u32,
    b: &amp;'b NoCopyType
}

fn main()
{ 
  /* 'a tied to fn-main stackframe */
  let var_a = 35;
  let example: Example;
  
  {
    /* Lifetime 'b tied to new stackframe/scope */ 
    let var_b = NoCopyType {};
    
    /* fixme */
    example = Example { a: &amp;var_a, b: &amp;var_b };
  }
  
  println!(&quot;(Success!) {:?}&quot;, example);
}
</code></pre></pre>
<p>8、 🌟🌟</p>
<pre><pre class="playground"><code class="language-rust editable edition2021">
#[derive(Debug)]
struct NoCopyType {}

#[derive(Debug)]
#[allow(dead_code)]
struct Example&lt;'a, 'b&gt; {
    a: &amp;'a u32,
    b: &amp;'b NoCopyType
}

/* Fix function signature */
fn fix_me(foo: &amp;Example) -&gt; &amp;NoCopyType
{ foo.b }

fn main()
{
    let no_copy = NoCopyType {};
    let example = Example { a: &amp;1, b: &amp;no_copy };
    fix_me(&amp;example);
    println!(&quot;Success!&quot;)
}
</code></pre></pre>
<h2 id="method"><a class="header" href="#method">Method</a></h2>
<p>Methods are annotated similarly to functions.</p>
<p><strong>Example</strong></p>
<pre><pre class="playground"><code class="language-rust editable edition2021">struct Owner(i32);

impl Owner {
    // Annotate lifetimes as in a standalone function.
    fn add_one&lt;'a&gt;(&amp;'a mut self) { self.0 += 1; }
    fn print&lt;'a&gt;(&amp;'a self) {
        println!(&quot;`print`: {}&quot;, self.0);
    }
}

fn main() {
    let mut owner = Owner(18);

    owner.add_one();
    owner.print();
}
</code></pre></pre>
<p>9、🌟🌟</p>
<pre><pre class="playground"><code class="language-rust editable edition2021">/* Make it work by adding proper lifetime annotations */
struct ImportantExcerpt {
    part: &amp;str,
}

impl ImportantExcerpt {
    fn level(&amp;'a self) -&gt; i32 {
        3
    }
}

fn main() {}
</code></pre></pre>
<h2 id="elision"><a class="header" href="#elision">Elision</a></h2>
<p>Some lifetime patterns are so comman that the borrow checker will allow you to omit them to save typing and to improve readability.</p>
<p>This is known as <strong>Elision</strong>. Elision exist in Rust only because these patterns are common.</p>
<p>For a more comprehensive understanding of elision, please see <a href="https://doc.rust-lang.org/book/ch10-03-lifetime-syntax.html#lifetime-elision">lifetime elision</a> in the official book.</p>
<p>10、🌟🌟</p>
<pre><pre class="playground"><code class="language-rust editable edition2021">/* Remove all the lifetimes that can be elided */

fn nput&lt;'a&gt;(x: &amp;'a i32) {
    println!(&quot;`annotated_input`: {}&quot;, x);
}

fn pass&lt;'a&gt;(x: &amp;'a i32) -&gt; &amp;'a i32 { x }

fn longest&lt;'a, 'b&gt;(x: &amp;'a str, y: &amp;'b str) -&gt; &amp;'a str {
    x
}

struct Owner(i32);

impl Owner {
    // Annotate lifetimes as in a standalone function.
    fn add_one&lt;'a&gt;(&amp;'a mut self) { self.0 += 1; }
    fn print&lt;'a&gt;(&amp;'a self) {
        println!(&quot;`print`: {}&quot;, self.0);
    }
}

struct Person&lt;'a&gt; {
    age: u8,
    name: &amp;'a str,
}

enum Either&lt;'a&gt; {
    Num(i32),
    Ref(&amp;'a i32),
}

fn main() {}
</code></pre></pre>

                        <div id="giscus-container"></div>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../lifetime/intro.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../lifetime/static.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../lifetime/intro.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../lifetime/static.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>

        <script src="../ace.js" type="text/javascript" charset="utf-8"></script>
        <script src="../editor.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mode-rust.js" type="text/javascript" charset="utf-8"></script>
        <script src="../theme-dawn.js" type="text/javascript" charset="utf-8"></script>
        <script src="../theme-tomorrow_night.js" type="text/javascript" charset="utf-8"></script>

        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>
        <script type="text/javascript" charset="utf-8">
        var pagePath = "lifetime/basic.md"
        </script>


        <!-- Custom JS scripts -->
        <script type="text/javascript" src="../assets/custom3.js"></script>
        <script type="text/javascript" src="../assets/lang.js"></script>


    </body>
</html>